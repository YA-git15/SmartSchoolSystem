<!DOCTYPE html>
<html lang='ja'>

<head>
	<meta charset='utf-8' />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link href='https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css' rel='stylesheet'>
	<link href='https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css' rel='stylesheet'>
	<link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=M+PLUS+1:wght@100..900&display=swap" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.17/main.min.css" rel="stylesheet">
	<link rel="stylesheet" th:href="@{/css/style.css}">
	<script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.17/index.global.min.js'></script>
</head>

<body>
	<header class="container-fluid header">
		<div class="row shcool-name-and-nav">
			<div class="col-12 col-md-6 school-name">
				<a href="/home" class="d-flex align-items-center text-decoration-none text-dark">
					<img src="/images/logo_system.png" alt="ロゴ" class="img-fluid"
						style="width: 20%; margin-right: 10px;">
					<h2 class="mb-0">横浜市立新横浜小学校</h2>
				</a>
			</div>

			<div class="col-12 col-md-6 nav-link">
				<div class="row navs">
					<div class="col-3"><a th:href="@{/notices}">お知らせ</a></div>
					<div class="col-3"><a th:href="@{/events}">行事予定</a></div>
					<div class="col-3"><a th:href="@{/inqueries}">問い合わせ</a></div>
					<div class="col-3"><a th:href="@{/logout}">ログアウト</a></div>
				</div>
			</div>

		</div>


		<div class="card border-light text-dark">
			<img src="images/header.jpg" class="card-img" alt="背景画像">
			<div class="card-img-overlay d-flex">
				<div class="my-auto">
					<h1 class="page-title">行事カレンダー</h1>
				</div>
			</div>

		</div>
	</header>

	<main class="main-contents">
		<a th:href="@{/events/addEvent}">新規追加</a>
		<div class="conatainer-fluid">
			<div class="row">
				<div class="col-8">
					<div class="row">
						<div class="col-12 calendar-events-title">月間予定</div>
					</div>
					<div class="row">
						<div class="col-12 calendar-events" id='calendar'></div>
					</div>
				</div>
				<div class="col-4">
					<div class="row">
						<div class="col-12 list-events-title">年間予定</div>
						<div class="col-12 list-events">
							<table class="table table-hover listnotice-table">
								<thead>
									<tr>
										<div class="row event-list">
											<div class="col-4 event-date">Date</div>
											<div class="col-8 event-title">行事名</div>
										</div>
									</tr>
								</thead>
								<tbody>
									<tr th:each="event : ${events}">
										<td>
											<a th:href="@{/events/detailEvent/{id}(id=${event.eventId})}"
												class="table-link">
												<div class="row event-list">
													<div class="col-4">
														[[${#temporals.format(event.eventStartDatetime,'MM月dd日')}]]
													</div>
													<div class="col-8">[[${event.eventTitle}]]</div>
												</div>
											</a>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
	</main>


	<script>
		document.addEventListener('DOMContentLoaded', function () {
			var calendarEl = document.getElementById('calendar');

			var calendar = new FullCalendar.Calendar(calendarEl, {


				displayEventTime: false,
				timeZone: 'Asia/Tokyo',  // 日本時間に設定
				locale: 'ja',
				width: 150,

				headerToolbar: {
					left: 'prev,next today',
					center: 'title',
					right: 'dayGridMonth,timeGridWeek,timeGridDay'
				},

				// buttonText設定
				buttonText: {
					month: '月',
					week: '週',
					day: '日',
					today: '本日'

				},

				events: '/events/json',

				// クリックイベントを追加
				eventClick: function (info) {
					// イベントのIDを取得
					var eventId = info.event.id;

					// コントローラーに遷移するURLを生成
					var detailUrl = '/events/detailEvent/' + eventId;

					// 新しいウィンドウで詳細ページを開く
					window.open(detailUrl, '_blank');  // _blank で新しいウィンドウを開く
					info.jsEvent.preventDefault(); // リンクのデフォルト動作をキャンセル
				},



			});

			calendar.setOption('aspectRatio', 1.5);

			calendar.render();
		});
	</script>

</body>

</html>